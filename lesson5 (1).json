{"paragraphs":[{"text":"%pyspark\n\nfrom pyspark.sql import SparkSession\n\nspark = (\n    SparkSession\n    .builder\n    .appName(\"MyApp\")\n    .getOrCreate()\n    )","user":"anonymous","dateUpdated":"2022-09-19T17:19:50+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1663605077051_-963368837","id":"20220919-163117_1661602156","dateCreated":"2022-09-19T16:31:17+0000","dateStarted":"2022-09-19T17:19:50+0000","dateFinished":"2022-09-19T17:19:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:357"},{"text":"%pyspark\ndf1 = (\n    spark\n    .createDataFrame([(1, \"andy\", 20, \"USA\"), (2, \"jeff\", 23, \"China\"), (3, \"james\", 18, \"USA\")])\n    .toDF(\"id\", \"name\", \"age\", \"country\")\n    )\n    \ndf1.show()\n         ","user":"anonymous","dateUpdated":"2022-09-19T17:20:29+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+-----+---+-------+\n| id| name|age|country|\n+---+-----+---+-------+\n|  1| andy| 20|    USA|\n|  2| jeff| 23|  China|\n|  3|james| 18|    USA|\n+---+-----+---+-------+\n\n"}]},"apps":[],"jobName":"paragraph_1663606410530_925917976","id":"20220919-165330_623917529","dateCreated":"2022-09-19T16:53:30+0000","dateStarted":"2022-09-19T17:20:29+0000","dateFinished":"2022-09-19T17:20:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:358"},{"text":"%pyspark\ndf1.createOrReplaceTempView(\"users\")\n# df1.write.saveAsTable('')\nspark.udf.register('up', lambda x: x.upper())\n\nspark.sql(\"select id, up(name), age, country from users where age > 18\").show()","user":"anonymous","dateUpdated":"2022-09-19T17:32:16+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+--------+---+-------+\n| id|up(name)|age|country|\n+---+--------+---+-------+\n|  1|    ANDY| 20|    USA|\n|  2|    JEFF| 23|  China|\n+---+--------+---+-------+\n\n"}]},"apps":[],"jobName":"paragraph_1663608040437_-1911112063","id":"20220919-172040_62763366","dateCreated":"2022-09-19T17:20:40+0000","dateStarted":"2022-09-19T17:32:16+0000","dateFinished":"2022-09-19T17:32:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:359"},{"text":"%pyspark\n'a'.upper()","user":"anonymous","dateUpdated":"2022-09-19T17:31:36+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"'A'"}]},"apps":[],"jobName":"paragraph_1663608681656_-866678849","id":"20220919-173121_2107590232","dateCreated":"2022-09-19T17:31:21+0000","dateStarted":"2022-09-19T17:31:36+0000","dateFinished":"2022-09-19T17:31:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:360"},{"text":"%pyspark\n\nrdd = sc.parallelize(\n    [\n        (0, \"A\", 223, \"PORT\"), \n        (0, \"A\", 22, \"PORT\"), \n        (0, \"A\", 422, \"DOCK\"), \n        (1,\"B\", 3213, \"DOCK\"), \n        (1,\"B\", 3213,\"PORT\"), \n        (2,\"C\", 2321,\"DOCK\")\n    ]\n)\ndf_data = sqlContext.createDataFrame(rdd, [\"id\",\"type\", \"cost\", \"ship\"])\n\ndf_data.show()","user":"anonymous","dateUpdated":"2022-09-19T17:37:40+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+----+----+----+\n| id|type|cost|ship|\n+---+----+----+----+\n|  0|   A| 223|PORT|\n|  0|   A|  22|PORT|\n|  0|   A| 422|DOCK|\n|  1|   B|3213|DOCK|\n|  1|   B|3213|PORT|\n|  2|   C|2321|DOCK|\n+---+----+----+----+\n\n"}]},"apps":[],"jobName":"paragraph_1663605119466_-974276995","id":"20220919-163159_298132701","dateCreated":"2022-09-19T16:31:59+0000","dateStarted":"2022-09-19T17:37:40+0000","dateFinished":"2022-09-19T17:37:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:361"},{"text":"%pyspark\nimport pyspark.sql.functions as F\n\npivoted_df = (\n    df_data\n    .groupby(df_data.id, df_data.type)\n    .pivot(\"ship\")\n    .agg(F.max(\"cost\"))\n)\n\npivoted_df.show()","user":"anonymous","dateUpdated":"2022-09-19T17:39:20+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+----+----+----+\n| id|type|DOCK|PORT|\n+---+----+----+----+\n|  1|   B|3213|3213|\n|  2|   C|2321|null|\n|  0|   A| 422| 223|\n+---+----+----+----+\n\n"}]},"apps":[],"jobName":"paragraph_1663605151623_-2115319415","id":"20220919-163231_915186706","dateCreated":"2022-09-19T16:32:31+0000","dateStarted":"2022-09-19T17:39:20+0000","dateFinished":"2022-09-19T17:40:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:362"},{"text":"%pyspark\nunpivotExpr = \"stack(2, 'P', PORT, 'D', DOCK) as (date, ship)\"\n\nunpivoted_df = pivoted_df.select(\"id\",\"type\", F.expr(unpivotExpr))\nunpivoted_df.show()","user":"anonymous","dateUpdated":"2022-09-19T17:42:16+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+----+----+----+\n| id|type|date|ship|\n+---+----+----+----+\n|  1|   B|   P|3213|\n|  1|   B|   D|3213|\n|  2|   C|   P|null|\n|  2|   C|   D|2321|\n|  0|   A|   P| 223|\n|  0|   A|   D| 422|\n+---+----+----+----+\n\n"}]},"apps":[],"jobName":"paragraph_1663605232656_-1294807022","id":"20220919-163352_551985438","dateCreated":"2022-09-19T16:33:52+0000","dateStarted":"2022-09-19T17:42:16+0000","dateFinished":"2022-09-19T17:42:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:363"},{"text":"%pyspark\nВывести логический и физический план любого запроса.","user":"anonymous","dateUpdated":"2022-09-19T16:44:16+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1663605856859_-1495627939","id":"20220919-164416_250728773","dateCreated":"2022-09-19T16:44:16+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:364"}],"name":"lesson5","id":"2HD68T558","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}