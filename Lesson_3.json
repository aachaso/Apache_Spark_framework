{"paragraphs":[{"text":"%pyspark\n\nfrom pyspark.sql import SparkSession\n\nspark = SparkSession \\\n    .builder \\\n    .appName(\"Python Spark SQL basic example\") \\\n    .config(\"spark.some.config.option\", \"some-value\") \\\n    .getOrCreate()","user":"anonymous","dateUpdated":"2022-09-12T20:11:59+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1663013495275_-1814437331","id":"20220912-171420_1072074840","dateCreated":"2022-09-12T20:11:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:247","dateFinished":"2022-09-12T20:12:19+0000","dateStarted":"2022-09-12T20:12:00+0000"},{"text":"%pyspark\nsc = spark.sparkContext","user":"anonymous","dateUpdated":"2022-09-12T20:12:26+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1663013495283_-1501650492","id":"20220912-171550_1318579640","dateCreated":"2022-09-12T20:11:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:248","dateFinished":"2022-09-12T20:12:26+0000","dateStarted":"2022-09-12T20:12:26+0000"},{"text":"%pyspark\ndata = [\n    ('a',1),\n    ('a',2),\n    ('b',2),\n    ('b',3),\n    ]\n    \ndataRDD = sc.parallelize(data,3)\n\ndataRDD.collect()","user":"anonymous","dateUpdated":"2022-09-12T20:17:29+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('a', 1), ('a', 2), ('b', 2), ('b', 3)]"}]},"apps":[],"jobName":"paragraph_1663013495283_-335534212","id":"20220912-171432_1197992603","dateCreated":"2022-09-12T20:11:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:249","dateFinished":"2022-09-12T20:17:29+0000","dateStarted":"2022-09-12T20:17:29+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=1"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\ndataRDD.getNumPartitions()","user":"anonymous","dateUpdated":"2022-09-12T20:11:35+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"3"}]},"apps":[],"jobName":"paragraph_1663013495284_-1945329536","id":"20220912-171828_488597717","dateCreated":"2022-09-12T20:11:35+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:250"},{"text":"%pyspark\ndataRDD.glom().collect()","user":"anonymous","dateUpdated":"2022-09-12T20:11:35+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[[('a', 1)], [('a', 2)], [('b', 2), ('b', 3)]]"}]},"apps":[],"jobName":"paragraph_1663013495285_793142322","id":"20220912-171931_585411781","dateCreated":"2022-09-12T20:11:35+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:251"},{"text":"%pyspark\n\nagesData = sc.parallelize([\n    ('B',20),\n    ('J',25),\n    ('A',18),\n    ('B',25),\n    ])\n    \nagesData.collect()","user":"anonymous","dateUpdated":"2022-09-12T20:30:47+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('B', 20), ('J', 25), ('A', 18), ('B', 25)]"}]},"apps":[],"jobName":"paragraph_1663013495286_-1327259785","id":"20220912-171932_1056256726","dateCreated":"2022-09-12T20:11:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:252","dateFinished":"2022-09-12T20:30:47+0000","dateStarted":"2022-09-12T20:30:47+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=4"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\nmap_1 = agesData.map(lambda x: (x[0], (x[1], 1)))\nmap_1.collect()","user":"anonymous","dateUpdated":"2022-09-12T20:31:06+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('B', (20, 1)), ('J', (25, 1)), ('A', (18, 1)), ('B', (25, 1))]"}]},"apps":[],"jobName":"paragraph_1663013495286_-1807596773","id":"20220912-171932_1819835997","dateCreated":"2022-09-12T20:11:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:253","dateFinished":"2022-09-12T20:31:07+0000","dateStarted":"2022-09-12T20:31:06+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=5"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\n\nreduce = map_1.reduceByKey(lambda x,y: (x[0] + y[0], x[1] + y[1]))","user":"anonymous","dateUpdated":"2022-09-12T20:11:35+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1663013495287_-1610132653","id":"20220912-171933_273873255","dateCreated":"2022-09-12T20:11:35+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:254"},{"text":"%pyspark\n\nmap_2 = reduce.map(lambda x: (x[0], x[1][0] / x[1][1] ))\n# map_2.collect()","user":"anonymous","dateUpdated":"2022-09-12T20:11:35+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1663013495288_1996380297","id":"20220912-171932_2016714333","dateCreated":"2022-09-12T20:11:35+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:255"},{"text":"%pyspark\nmap_2.filter(lambda x: x[1] > 18).collect()","user":"anonymous","dateUpdated":"2022-09-12T20:11:35+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('B', 22), ('J', 25)]"}]},"apps":[],"jobName":"paragraph_1663013495288_-51014968","id":"20220912-174626_842458398","dateCreated":"2022-09-12T20:11:35+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:256"},{"text":"%pyspark\n\ndata = sc.parallelize(\n    [\n    ('a', 'a b c'),\n    ('b', 'd e f'),\n    ]\n    )\n    \ndata.collect()","user":"anonymous","dateUpdated":"2022-09-12T20:11:35+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('a', 'a b c'), ('b', 'd e f')]"}]},"apps":[],"jobName":"paragraph_1663013495289_-821560299","id":"20220912-173651_904964913","dateCreated":"2022-09-12T20:11:35+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:257"},{"text":"%pyspark\n\ndata.flatMap(lambda x: x[1].split(' ')).collect()\n","user":"anonymous","dateUpdated":"2022-09-12T20:11:35+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['a', 'b', 'c', 'd', 'e', 'f']"}]},"apps":[],"jobName":"paragraph_1663013495290_1987994639","id":"20220912-173652_786656015","dateCreated":"2022-09-12T20:11:35+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:258"},{"text":"%pyspark\ndata.distinct().collect()","user":"anonymous","dateUpdated":"2022-09-12T20:11:35+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('b', 'd e f'), ('a', 'a b c')]"}]},"apps":[],"jobName":"paragraph_1663013495290_-491729313","id":"20220912-174112_948021470","dateCreated":"2022-09-12T20:11:35+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:259"},{"text":"%pyspark\n\nagesData = sc.parallelize([\n    ('B',20),\n    ('J',25),\n    ('A',18),\n    ('B',25),\n    ])\n    \nsalaryData = sc.parallelize([\n    ('B',2000),\n    # ('J',2500),\n    ('A',1800),\n    ('B',2500),\n    ])\n    \nagesData.join(salaryData).collect()","user":"anonymous","dateUpdated":"2022-09-12T20:11:35+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('A', (18, 1800)),\n ('B', (20, 2000)),\n ('B', (20, 2500)),\n ('B', (25, 2000)),\n ('B', (25, 2500))]"}]},"apps":[],"jobName":"paragraph_1663013495291_-284453131","id":"20220912-174112_147810239","dateCreated":"2022-09-12T20:11:35+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:260"},{"text":"%pyspark\nagesData.union(salaryData).collect()","user":"anonymous","dateUpdated":"2022-09-12T20:11:35+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('B', 20),\n ('J', 25),\n ('A', 18),\n ('B', 25),\n ('B', 2000),\n ('J', 2500),\n ('A', 1800),\n ('B', 2500)]"}]},"apps":[],"jobName":"paragraph_1663013495291_1488363994","id":"20220912-174113_1977580959","dateCreated":"2022-09-12T20:11:35+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:261"},{"text":"%pyspark\n\nagesData.leftOuterJoin(salaryData.hint(\"broadcast\")).collect()","user":"anonymous","dateUpdated":"2022-09-12T20:11:35+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('A', (18, 1800)),\n ('B', (20, 2000)),\n ('B', (20, 2500)),\n ('B', (25, 2000)),\n ('B', (25, 2500)),\n ('J', (25, None))]"}]},"apps":[],"jobName":"paragraph_1663013495292_-223018541","id":"20220912-174113_211484986","dateCreated":"2022-09-12T20:11:35+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:262"},{"text":"// ДЗ: Создать RDD в котором хранится список из 5 произвольных предложений. Посчитать количество вхождений каждого слова.","user":"anonymous","dateUpdated":"2022-09-12T20:11:35+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1663013495292_1857611010","id":"20220912-174114_1985704843","dateCreated":"2022-09-12T20:11:35+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:263"},{"text":"%pyspark\nData_word = sc.parallelize([\n    'There are several ways to create a list',\n    'To create a list, square brackets are used, inside which the elements of the list are listed separated by commas',\n    'And another way to create a list is list generators',\n    'The list does not have to contain only objects of the same type',\n    'A more complex list generator is also possible:',\n    'Create created, now you need to do something with the list',\n    'To check the elements of a list, you can use the standard print function, which prints the contents of the list',\n    'And, finally, examples of working with lists',\n    ])\n","user":"anonymous","dateUpdated":"2022-09-12T20:57:30+0000","config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1663013495293_1309375319","id":"20220912-174113_2110594246","dateCreated":"2022-09-12T20:11:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:264","dateFinished":"2022-09-12T20:57:30+0000","dateStarted":"2022-09-12T20:57:30+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\nresult = (Data_word\n    .flatMap(lambda i: i.split(\" \"))\n    .map(lambda i: (i, 1))\n    .reduceByKey(lambda x,y: (x + y))\n    )\n    \nresult.collect()","user":"anonymous","dateUpdated":"2022-09-12T20:57:32+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1663015387144_110519264","id":"20220912-204307_1118079464","dateCreated":"2022-09-12T20:43:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2845","dateFinished":"2022-09-12T20:57:32+0000","dateStarted":"2022-09-12T20:57:32+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('separated', 1),\n ('prints', 1),\n ('square', 1),\n ('created,', 1),\n ('have', 1),\n ('commas', 1),\n ('And,', 1),\n ('is', 2),\n ('There', 1),\n ('To', 2),\n ('are', 3),\n ('another', 1),\n ('need', 1),\n ('check', 1),\n ('contents', 1),\n ('use', 1),\n ('generator', 1),\n ('brackets', 1),\n ('ways', 1),\n ('create', 3),\n ('same', 1),\n ('possible:', 1),\n ('to', 4),\n ('only', 1),\n ('complex', 1),\n ('generators', 1),\n ('listed', 1),\n ('which', 2),\n ('print', 1),\n ('you', 2),\n ('several', 1),\n ('type', 1),\n ('Create', 1),\n ('more', 1),\n ('A', 1),\n ('do', 1),\n ('elements', 2),\n ('way', 1),\n ('something', 1),\n ('contain', 1),\n ('lists', 1),\n ('standard', 1),\n ('objects', 1),\n ('a', 4),\n ('not', 1),\n ('The', 1),\n ('now', 1),\n ('with', 2),\n ('by', 1),\n ('And', 1),\n ('also', 1),\n ('working', 1),\n ('list,', 2),\n ('used,', 1),\n ('inside', 1),\n ('list', 8),\n ('can', 1),\n ('does', 1),\n ('of', 5),\n ('the', 8),\n ('finally,', 1),\n ('function,', 1),\n ('examples', 1)]"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=25"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\nprint(result.takeOrdered(3, key=lambda x: -int(x[1])))","user":"anonymous","dateUpdated":"2022-09-12T20:57:38+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1663015264859_-1618707133","id":"20220912-204104_1051395894","dateCreated":"2022-09-12T20:41:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2708","dateFinished":"2022-09-12T20:57:38+0000","dateStarted":"2022-09-12T20:57:38+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('list', 8), ('the', 8), ('of', 5)]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=26"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2022-09-12T20:49:48+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1663015788096_1708906531","id":"20220912-204948_1693904917","dateCreated":"2022-09-12T20:49:48+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3008"}],"name":"Lesson_3","id":"2HEVD11Z7","noteParams":{},"noteForms":{},"angularObjects":{},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}